<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Earn high APR on your USDC deposits on Base Network" />
    <meta name="theme-color" content="#3B82F6" />
    <title>EarnUSDC | High Yield USDC Deposits on Base</title>
    
    <!-- Preload critical resources -->
    <link rel="preconnect" href="https://mainnet.base.org" />
    <link rel="preconnect" href="https://cdn.tailwindcss.com" />
    
    <!-- External Dependencies -->
    <script src="https://cdn.tailwindcss.com?v=3.4.1"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.8.2/web3.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    
    <!-- Tailwind Configuration -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              base: {
                blue: '#0052FF',
                black: '#0A0B0D'
              }
            }
          }
        }
      }
    </script>
    
    <!-- Custom Styles -->
    <style>
      /* Custom scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      ::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #666;
      }
      
      /* Number input styles */
      input[type="number"]::-webkit-inner-spin-button,
      input[type="number"]::-webkit-outer-spin-button {
        opacity: 1;
      }
      
      /* Alert animations */
      .alert {
        animation: slideIn 0.3s ease-out;
      }
      @keyframes slideIn {
        from {
          transform: translateY(-100%);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      
      /* Loading spinner animation */
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
      .animate-spin {
        animation: spin 1s linear infinite;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <!-- App Container -->
    <div id="root" class="min-h-screen">
      <div class="max-w-4xl mx-auto px-4 py-8 sm:px-6 lg:px-8">
        <!-- Header -->
        <header class="mb-8">
          <div class="flex justify-between items-center">
            <h1 class="text-2xl font-bold text-base-black">EarnUSDC</h1>
            <div class="flex items-center space-x-4">
              <a 
                href="https://basescan.org/address/0x9cf81A1814D452D4f5308aA38D128ce5CAADdDE4" 
                target="_blank" 
                rel="noopener noreferrer"
                class="text-sm text-gray-500 hover:text-gray-700 transition-colors"
              >
                Contract
              </a>
              <a 
                href="https://docs.base.org" 
                target="_blank" 
                rel="noopener noreferrer"
                class="text-sm text-gray-500 hover:text-gray-700 transition-colors"
              >
                About Base
              </a>
            </div>
          </div>
        </header>

        <!-- Main Content -->
        <main>
          <!-- Card Container -->
          <div class="bg-white rounded-xl shadow-lg overflow-hidden">
            <!-- Alert Container -->
            <div id="alertContainer" class="sticky top-0 z-10"></div>
            
            <!-- Main Content Area -->
            <div id="mainContent" class="p-4 sm:p-6"></div>
          </div>
        </main>
        
        <!-- Footer -->
        <footer class="mt-8 text-center text-sm text-gray-500">
          <p>Built on Base Network</p>
        </footer>
      </div>
    </div>

    <!-- Error Boundary -->
    <div id="errorBoundary" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white p-6 rounded-lg max-w-md mx-4">
        <h2 class="text-xl font-bold text-red-600 mb-2">Error</h2>
        <p id="errorMessage" class="text-gray-700 mb-4"></p>
        <button 
          onclick="window.location.reload()" 
          class="w-full bg-blue-500 text-white rounded px-4 py-2 hover:bg-blue-600 transition-colors"
        >
          Reload Application
        </button>
      </div>
    </div>

<!-- Application Scripts -->
<script src="config.js"></script>
<script src="utils.js"></script>
<script src="state.js"></script>
<script src="wallet.js"></script>
<script src="transaction.js"></script>
<script src="ui.js"></script>
    
<!-- index.html の該当部分を変更 -->
<script>
  // Global error handler
  window.onerror = function(msg, src, line, col, error) {
    console.error('Global error:', { msg, src, line, col, error });  // この行はそのまま
    
    // エラーメッセージをより詳細に
    document.getElementById('errorMessage').textContent = 
      `Error: ${msg}\nLine: ${line}\nSource: ${src}`;
    document.getElementById('errorBoundary').classList.remove('hidden');
    return false;
  };

  // DOMContentLoadedのエラーもキャッチ
  document.addEventListener('DOMContentLoaded', function() {
    window.addEventListener('unhandledrejection', function(event) {
      console.error('Unhandled promise rejection:', event.reason);
      document.getElementById('errorMessage').textContent = 
        `Async Error: ${event.reason}`;
      document.getElementById('errorBoundary').classList.remove('hidden');
    });
  });
</script>
  </body>
</html>
